<div class="mobile-container" *ngIf="order">

  <div class="status-header" [ngClass]="getStatusClass(order.status)">
    
    <div class="icon-wrapper pulse">
      <mat-icon *ngIf="order.status === 'recebido'">restaurant</mat-icon>
      <mat-icon *ngIf="order.status === 'preparando'">soup_kitchen</mat-icon>
      <mat-icon *ngIf="order.status === 'pronto'">check_circle</mat-icon>
      <mat-icon *ngIf="order.status === 'entregue'">thumb_up</mat-icon>
    </div>

    <h1>{{ order.status | uppercase }}</h1>
    
    <p class="status-desc" *ngIf="order.status === 'recebido'">Aguardando a cozinha aceitar...</p>
    <p class="status-desc" *ngIf="order.status === 'preparando'">Seu pedido estÃ¡ no fogo! ğŸ”¥</p>
    <p class="status-desc" *ngIf="order.status === 'pronto'">Pode retirar no balcÃ£o! ğŸ˜‹</p>
    
    <div class="progress-container">
      <mat-progress-bar 
        mode="determinate" 
        [value]="getProgressValue(order.status)" 
        class="custom-progress">
      </mat-progress-bar>
    </div>
  </div>

  <div class="content">
    
    <mat-card class="receipt-card">
      <mat-card-header>
        <mat-card-title>Resumo do Pedido</mat-card-title>
        <mat-card-subtitle>
          Pedido #{{ order.idOrder || order.idorder }} â€¢ Mesa {{ order.deskNumber || order.desknumber || order.idDesk || '?' }}
        </mat-card-subtitle>     
      </mat-card-header>
      
      <mat-card-content>
        <mat-list>
          <mat-list-item *ngFor="let item of items" class="receipt-item">
            <span matListItemTitle class="item-title">
              <span class="qty">{{ item.amount }}x</span> {{ item.name }}
            </span>
            
            <span matListItemLine *ngIf="item.observation" class="obs">
              âš ï¸ {{ item.observation }}
            </span>

            <span matListItemLine *ngIf="item.custom" class="custom">
               <span *ngFor="let k of getCustomKeys(item.custom)">+ {{ item.custom[k] }} </span>
            </span>

            <span matListItemMeta class="price">R$ {{ item.unitPrice * item.amount | number:'1.2-2' }}</span>
          </mat-list-item>
        </mat-list>

        <mat-divider></mat-divider>

        <div class="total-row">
          <span>Total a Pagar</span>
          <span class="total-value">R$ {{ order.total | number:'1.2-2' }}</span>
        </div>
      </mat-card-content>
    </mat-card>

  </div>

  <div class="bottom-action">
    <button mat-flat-button color="primary" class="btn-large" routerLink="/menu/{{order.idDesk || order.desknumber || 1}}">
      FAZER NOVO PEDIDO
    </button>
  </div>

</div>

<div *ngIf="!order" class="loading-screen">
  <mat-spinner diameter="40"></mat-spinner>
  <p>Buscando seu pedido...</p>
</div>